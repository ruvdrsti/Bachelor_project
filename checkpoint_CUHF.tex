\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{braket}
\title{Checkpoint CUHF}
\author{ruvdrsti}
\date{March 2021}

\begin{document}

\maketitle

\section{Problems}
\label{sec:prob}
\subsection{Restricted Open Shell Hartree-Fock}
\label{subsec:ROHF}
\begin{itemize}
    \item no unique Fock operator
    \item hard to interpret uniformly
\end{itemize}
 When looking at the Fock operator, we see equations like Equation \eqref{eq: ROHF fock}.
 \begin{equation}\label{eq: ROHF fock}
     R_{cc} = A_{cc}F^\alpha_{cc} + B_{cc}F^\beta_{cc}
 \end{equation}
 Since fixed values for the A and B factors exist, the Fock operator and consequently its eigenvalues can vary depending on these values. However, the wave function and total energy 
 remain the same. This make the interpretation of the eigenvalues difficult. They no longer follow Koopmans' theorem.
\subsection{Unrestricted Hartee-Fock}
\label{subsec:UHF}
\begin{itemize}
    \item spin-contamination
    \item loss of information
\end{itemize}
When orbitals are allowed to vary, we will see overlap terms in the expectation value of the $S^2$ operator. This results in the loss of a quantum number, since the wave function 
will no longer be an eigenfunction of said operator. We can imagine that this will be detrimental when studying systems that contain a lot of paired electrons, since for 
every $\alpha$-$\beta$ pair, an overlap term will show up.

\section{Spin Contamination}
\label{sec:spincon}
It is known that spin contamination is given by Equation \eqref{eq:spincon1}.
\begin{equation}\label{eq:spincon1}
    \delta_s = \braket{S^2} - S_z(S_z + 1) = N_\beta - Tr(\gamma_\alpha\gamma_\beta)
\end{equation}
Naturally the next course of action would be to calculate what $Tr(\gamma_\alpha\gamma_\beta)$ actually is. After some work, we can find Equation \eqref{eq:spincon2}

\begin{equation}\label{eq:spincon2}
    \delta_s = N_\beta - Tr(\gamma_\alpha\gamma_\beta) = 4\sum_i^{N_{cp}}m_i
\end{equation}
We then see that if we want to eliminate spin contamination entirely, $m_i$ needs to be zero. Given that $m_i = \sqrt{n_i - n_i^2}$, we can clearly see that $n_i$ can then only equal 
0 or 1. Since $n_i$ is the occupation of the orbital i, we can only have empty orbitals or paired ones. Unpaired electrons are not considered. Intuitively, it can be understood that 
spin contamination occurs when electrons on the same energy level start occupying different orbitals if they have a different spin. If the electron is alone, there is nothing to 
compare it with.

\section{Getting Past Spin Contamination}
\label{sec:sol}
In the previous section we saw how we could minimize spin equation. Now we will enforce this rule. Using the Lagrange multipliers we can get the energy as Equation \eqref{eq:enforce}.

\begin{equation}\label{eq:enforce}
    E_{CUHF} = E_{UHF} + \sum_{ij}'\lambda_{ij}M_{ij}
\end{equation}
The Lagrange multipliers need to keep the $M_{ij}$ in check, since $m_i$ needs to be 0. The prime indicates that wee only need to consider the closed shell (doubly occupied) and 
virtual orbitals. If we can write the energy as Equation \eqref{eq:energy1}.

\begin{equation}\label{eq:energy1}
    E_{UHF} = E_{cs} + E_{c}
\end{equation}
Where $E_{cs}$, the closed-shell energy, is a function of the charge density matrix and $E_c$, the correlation energy, is a function of the spin density matrix. The correlation energy
 is a correction term. This is required because we are no longer working purely in a closed shell system. Given the expressions for these energies, we can derive that their 
 derivatives with respect to the original $\alpha$ and $\beta$ density matrices are respectively a Fock-operator and some variance $\Delta$ respectively. This is an incarnation of 
 the $E_c$, so we will see it as a correction that accounts for the fact that we are not working in a closed shell system.  When we fill this in we can define the individual Fock 
 operators as Equations \eqref{eq:fock1} and \eqref{eq:fock2}.
\begin{equation}\label{eq:fock1}
    F^\alpha = F^{cs} - \Delta^{UHF}
\end{equation}
\begin{equation}\label{eq:fock2}
    F^\beta = F^{cs} + \Delta^{UHF}
\end{equation}
Now we need to build in the constraint we have imposed in Equation \eqref{eq:enforce}. To do this, we take all closed shell and virtual orbitals and subtract a term $\lambda_{ij}/2$.
We do nothing when we are dealing with open shell orbitals, so $\Delta^{UHF} = \Delta^{UHF}$ This is the derivative of the constraint itself with respect to the density matrices.
We can then define a CUHF Fock operator as Equations \eqref{eq:fock3} and \eqref{eq:fock4}.
\begin{equation}\label{eq:fock3}
    \widetilde{F}^\alpha = F^{cs} - \Delta^{CUHF}
\end{equation}
\begin{equation}\label{eq:fock4}
    \widetilde{F}^\beta = F^{cs} + \Delta^{CUHF}
\end{equation}
We can easily note here that we have two different Fock operators that do not rely on arbitrary constants, unlike ROHF. Now we can look at the commutators 
$[\widetilde{F}^\alpha, \gamma_\alpha] = 0$ and $[\widetilde{F}^\beta, \gamma_\beta] = 0$. When this is true, the Fock operators have a complete set of eigenfucntions in common with 
the density matrix. If the eigenfunctions of the density matrix are  the natural orbitals, linear combinations of these NO's will be eigenfunctions of the Fock operator. 
(Since having a comlete set of eigenfunctions in common does not necessarily mean that every eigenfucntion of one operator will be an eigenfunction of the other.) 
Now we can assert some statements, Equations \eqref{eq:assert1}, \eqref{eq:assert2} and \eqref{eq:assert3}.
\begin{equation}\label{eq:assert1}
    F^{cs}_{co} + \Delta^{CUHF}_{co} = 0
\end{equation}
\begin{equation}\label{eq:assert2}
    F^{cs}_{vo} - \Delta^{CUHF}_{vo} = 0
\end{equation}
\begin{equation}\label{eq:assert3}
    \Delta^{CUHF}_{cv} = 0
\end{equation}
The last statement tells us that the Lagrange multipliers we impose upon the system must be of the form $2\Delta^{UHF}_{cv}$. This is the constraint we have to enforce if we are to 
eliminate spin elimination. We are now left with two CUHF Fock matrices which we can use in the way we would normally use UHF Fock matrices.

\section{Conclusion}
\label{sec:conc}
At this point we are left with a way to calculate the total wave function and energy, together with the eigenenergies of the individual orbitals. We are not hindered by spin 
contamination anymore, and we have not lost the meaning of the individual eigenvalues.  
\end{document}
